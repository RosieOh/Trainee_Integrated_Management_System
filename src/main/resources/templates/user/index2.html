<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{include/layout}">

<div layout:fragment="content">
  <div class="user_title">
    <h2>나의 정보</h2>
  </div>
  <div class="user_tab">
    <div class="user_tab_title"><a  th:href="@{/index2}" >기본정보</a></div>
    <div class="user_tab_title"><span>추가정보</span></div>
  </div>
<!--  <form th:action="@{/}" method="post" onsubmit="return modify(this)">-->
  <div class="user_content">
    <div class="user_content_seperate">
      <div class="user_info_container">
        <div class="user_info_box">
          <label for="id" >아이디</label>
          <input type="text" id="id" name="name" class="ro_input" value="beubeu95" readonly>
        </div>
        <div class="user_info_box infopw">
          <label for="pw" >비밀번호</label>
          <div class="myinfo_line">
            <input type="text"  id="pw" name="pw"  value="******" readonly>
            <a th:href="@{/pw}" class="btn_pwChange">비밀번호 변경</a>
          </div>
        </div>
        <div class="user_info_box infoemail">
          <label for="email">이메일</label>
          <div class="myinfo_line">
            <input type="text" name="email1" id="email1" value="gusrud95" />
            <p class="email_a">@&nbsp;</p>
            <input type="text" name="email2" id="email2" placeholder="chunjae.co.kr"/>
            <select id="email2_select">
              <option value="self">직접입력</option>
              <option value="naver.com">naver.com</option>
              <option value="google.com">google.com</option>
              <option value="kakao.com">kakao.com</option>
              <option value="daum.net">daum.net</option>
              <option value="hanmail.net">hanmail.net</option>
            </select>
            <input type="hidden" id="email" name="email" />
          </div>
        </div>
        <div class="user_info_box infobirth">
          <label for="phone">생일</label>
          <div class="myinfo_line">
            <input type="number" name="birth1" id="birth1" placeholder="1995" maxlength="4" />
            <p></p>
            <select name="birth2" id="birth2" >
              <option value="" selected>8월</option>
              <option value="01">1월</option>
              <option value="02">2월</option>
              <option value="03">3월</option>
              <option value="04">4월</option>
              <option value="05">5월</option>
              <option value="06">6월</option>
              <option value="07">7월</option>
              <option value="08">8월</option>
              <option value="09">9월</option>
              <option value="10">10월</option>
              <option value="11">11월</option>
              <option value="12">12월</option>
            </select>
            <p></p>
            <input type="number" name="birth3" id="birth3" placeholder="10" maxlength="2" />
            <input type="hidden" name="birth" id="birth"/>
          </div>
        </div>
        <div class="user_info_box">
          <label for="gender">성별</label>
          <div class="myinfo_line">
            <label><input type="radio" name="gender" id="gender" value="남자"/>남자</label>
            <label><input type="radio" name="gender" value="여자"/>여자</label>
          </div>
        </div>
        <div class="user_info_box infotel">
          <label for="phone">연락처</label>
          <div class="myinfo_line">
            <input type="tel" name="phone1" id="phone1" placeholder="010" maxlength="4" />
            <p class="email_a">-&nbsp;</p>
            <input type="tel" name="phone2" id="phone2" placeholder="1234" maxlength="4" />
            <p class="email_a">-&nbsp;</p>
            <input type="tel" name="phone3" id="phone3" placeholder="1234" maxlength="4" />
            <input type="hidden" name="phone" id="phone"/>
          </div>
        </div>
        <div class="user_info_box">
          <label for="phone">주소</label>
          <input type="text" name="postcode" id="postcode" placeholder="01325" class="postcodeBtn">
          <button type="button" id="post_btn" onclick="findAddr()" class="btn_myInfo">우편번호 검색</button>
        </div>
        <div class="user_info_box">
          <input type="text" name="addr1" id="addr1" placeholder="강원도 춘천시 퇴계동 913-7" class="" />
        </div>
        <div class="user_info_box">
          <input type="text" name="addr2" id="addr2" placeholder="3층" class=""/>
        </div>
      </div>
      <div class="user_info_container">
        <div class="user_info_box">
          <label for="stack" >기술스택</label>
          <input type="text" id="stack" name="stack">
        </div>
        <div class="user_info_box">
          <label for="exp" >경력</label>
          <input type="text" id="exp" name="exp">
        </div>
        <div class="user_info_box">
          <label for="cert" >자격증</label>
          <input type="text" id="cert" name="cert">
        </div>
        <div class="user_info_box">
          <label for="smoke" >흡연</label>
          <input type="text" id="smoke" name="smoke">
        </div>
        <div class="user_info_box">
          <label for="sick" >질병</label>
          <input type="text" id="sick" name="sick">
        </div>
      </div>
    </div>
    <div class="myinfo_btn_group">
      <button type="submit" class="btn_myInfo">회원정보수정</button>
      <a th:href="@{/}" class="btn_myInfo_out">회원탈퇴</a>
    </div>
  </div>
<!--  </form>-->
</div>

<script>
  const email2_select = document.querySelector('#email2_select')
  const email2 = document.querySelector('#email2')
  email2_select.addEventListener('change', (event) => {
    if(event.target.value !== "self") {
      email2.value = event.target.value
      email2.disabled = true
    } else {
      email2.value = ""
      email2.disabled = false
    }
  })
</script>
<script>
  function modify(f){
    let phoneval =  $("#phone1").val() + $("#phone2").val() + $("#phone3").val()
    $("#phone").val(phoneval)

    let emailval =  $("#email1").val() +'@'+ $("#email2").val()
    $("#email").val(emailval)

    let birthval =  $("#birth1").val() +'년'+ $("#birth2").val() +'월'+ $("#birth3").val() +'일'
    $("#birth").val(birthval)

    if(f.pw.value!=f.pw2.value){
      alert("비밀번호와 비밀번호 확인이 서로 다릅니다.");
      f.pw.focus();
      return false;
    }
    if(f.pw.value.length(8-16)){
      alert("비밀번호는 최소 8자리에서 최대 16자리까지 숫자, 영문, 특수문자 각 1개 이상 포함해주세요.");
      f.pw.focus();
      return false;
    }

    let value = $("#pw").val();

    let pattern="^(?=.*[A-Za-z])(?=.*\d)(?=.*[$@$!%*#?&.,])[A-Za-z\d$@$!%*#?&]{8,16}$"
    if (!pattern.test(value)) {
      alert("숫자, 영문, 특수문자 각 1개 이상 포함입니다.");
      $("#pw").focus();
      return false;
    }
  }
</script>
<script src="https://t1.daumcdn.net/mapjsapi/bundle/postcode/prod/postcode.v2.js"></script>
<script>
  function findAddr(){
    new daum.Postcode({
      oncomplete:function(data){
        var roadAddr = data.roadAddress;
        var jibunAddr = data.jibunAddress;
        var bname = data.bname;
        document.getElementById("postcode").value = data.zonecode;
        if(roadAddr !== ''){
          document.getElementById("addr1").value = roadAddr;
        } else if(jibunAddr !== ''){
          document.getElementById("addr1").value = jibunAddr;
        }
        document.getElementById("addr3").value = bname;
        document.getElementById("addr2").focus();
      }
    }).open();
  }
</script>